<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>problem36-40 | 宛丘</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">problem36-40</h1><a id="logo" href="/.">宛丘</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">problem36-40</h1><div class="post-meta">Mar 15, 2017<span> | </span><span class="category"><a href="/categories/99-problems-in-scala/">99-problems-in-scala</a></span></div><div class="post-content"><p><strong> 声明</strong><br>该系列文章来自：<a href="http://aperiodic.net/phil/scala/s-99/" target="_blank" rel="external">http://aperiodic.net/phil/scala/s-99/</a><br>大部分内容和原文相同,加入了部分自己的代码。<br>如有侵权，请及时联系本人。本人将立即删除相关内容。</p>
<h1 id="P36-Determine-the-prime-factors-of-a-given-positive-integer-2"><a href="#P36-Determine-the-prime-factors-of-a-given-positive-integer-2" class="headerlink" title="P36 (**) Determine the prime factors of a given positive integer (2)."></a>P36 (**) Determine the prime factors of a given positive integer (2).</h1><h2 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h2><p>Construct a list containing the prime factors and their multiplicity.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="number">315.</span>primeFactorMultiplicity</div><div class="line">res0: <span class="type">List</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">List</span>((<span class="number">3</span>,<span class="number">2</span>), (<span class="number">5</span>,<span class="number">1</span>), (<span class="number">7</span>,<span class="number">1</span>))</div></pre></td></tr></table></figure>
<p>Alternately, use a Map for the result.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="number">315.</span>primeFactorMultiplicity</div><div class="line">res0: <span class="type">Map</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="number">3</span> -&gt; <span class="number">2</span>, <span class="number">5</span> -&gt; <span class="number">1</span>, <span class="number">7</span> -&gt; <span class="number">1</span>)</div></pre></td></tr></table></figure>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> problem_31_to_40</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S99Int</span>(<span class="params">val start: <span class="type">Int</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">import</span> <span class="type">S99Int</span>._</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">primeFactorMultiplicity</span></span>: <span class="type">Map</span>[<span class="type">Int</span>, <span class="type">Int</span>] = &#123;</div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">factorCount</span></span>(n: <span class="type">Int</span>, p: <span class="type">Int</span>): (<span class="type">Int</span>, <span class="type">Int</span>) =</div><div class="line">            <span class="keyword">if</span> (n % p != <span class="number">0</span>) (<span class="number">0</span>, n)</div><div class="line">            <span class="keyword">else</span> factorCount(n / p, p) <span class="keyword">match</span> &#123; <span class="keyword">case</span> (c, d) =&gt; (c + <span class="number">1</span>, d) &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">factorsR</span></span>(n: <span class="type">Int</span>, ps: <span class="type">Stream</span>[<span class="type">Int</span>]): <span class="type">Map</span>[<span class="type">Int</span>, <span class="type">Int</span>] =</div><div class="line">            <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="type">Map</span>()</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (n.isPrime) <span class="type">Map</span>(n -&gt; <span class="number">1</span>)</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">val</span> nps = ps.dropWhile(n % _ != <span class="number">0</span>)</div><div class="line">                <span class="keyword">val</span> (count, dividend) = factorCount(n, nps.head)</div><div class="line">                <span class="type">Map</span>(nps.head -&gt; count) ++ factorsR(dividend, nps.tail)</div><div class="line">            &#125;</div><div class="line">        factorsR(start, primes)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="P37-Calculate-Euler’s-totient-function-phi-m-improved"><a href="#P37-Calculate-Euler’s-totient-function-phi-m-improved" class="headerlink" title="P37 (**) Calculate Euler’s totient function phi(m) (improved)."></a>P37 (**) Calculate Euler’s totient function phi(m) (improved).</h1><h2 id="要求-1"><a href="#要求-1" class="headerlink" title="要求"></a>要求</h2><p>See problem P34 for the definition of Euler’s totient function. If the list of the prime factors of a number m is known in the form of problem P36 then the function phi(m&gt;) can be efficiently calculated as follows: Let [[p1, m1], [p2, m2], [p3, m3], …] be the list of prime factors (and their multiplicities) of a given number m. Then phi(m) can be calculated with the following formula:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phi(m) = (p1-1)*p1^(m1-1) * (p2-1)*p2^(m2-1) * (p3-1)*p3^(m3-1) * ...</div></pre></td></tr></table></figure>
<p>Note that a^b stands for the bth power of a.</p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> problem_31_to_40</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S99Int</span>(<span class="params">val start: <span class="type">Int</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">import</span> <span class="type">S99Int</span>._</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totient2</span></span>: <span class="type">Int</span> = start.primeFactorMultiplicity.foldLeft(<span class="number">1</span>) &#123; (r, f) =&gt;</div><div class="line">        f <span class="keyword">match</span> &#123; <span class="keyword">case</span> (p, m) =&gt; r * (p - <span class="number">1</span>) * <span class="type">Math</span>.pow(p, m - <span class="number">1</span>).toInt &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="P39-A-list-of-prime-numbers"><a href="#P39-A-list-of-prime-numbers" class="headerlink" title="P39 (*) A list of prime numbers."></a>P39 (*) A list of prime numbers.</h1><h2 id="要求-2"><a href="#要求-2" class="headerlink" title="要求"></a>要求</h2><p>Given a range of integers by its lower and upper limit, construct a list of all prime numbers in that range.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala&gt; listPrimesinRange(<span class="number">7</span> to <span class="number">31</span>)</div><div class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>)</div></pre></td></tr></table></figure>
<h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><ul>
<li>(1):最简单最直观的方法就是遍历range，将是素数的留下来</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">S99Int</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">int2S99Int</span></span>(i: <span class="type">Int</span>): <span class="type">S99Int</span> = <span class="keyword">new</span> <span class="type">S99Int</span>(i)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">listPrimesinRange</span></span>(r: <span class="type">Range</span>): <span class="type">List</span>[<span class="type">Int</span>] =</div><div class="line">        r.filter(_.isPrime).toList</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>(2):原作者用的方法，更加高效</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">S99Int</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">int2S99Int</span></span>(i: <span class="type">Int</span>): <span class="type">S99Int</span> = <span class="keyword">new</span> <span class="type">S99Int</span>(i)</div><div class="line"></div><div class="line">    <span class="keyword">val</span> primes = <span class="type">Stream</span>.cons(<span class="number">2</span>, <span class="type">Stream</span>.from(<span class="number">3</span>, <span class="number">2</span>) filter &#123; _.isPrime &#125;)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">listPrimesinRange2</span></span>(r: <span class="type">Range</span>): <span class="type">List</span>[<span class="type">Int</span>] =</div><div class="line">        primes.dropWhile(_ &lt; r.start).takeWhile(_ &lt;= r.end).toList</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="P40-Goldbach’s-conjecture"><a href="#P40-Goldbach’s-conjecture" class="headerlink" title="P40 (**) Goldbach’s conjecture."></a>P40 (**) Goldbach’s conjecture.</h1><h2 id="要求-3"><a href="#要求-3" class="headerlink" title="要求"></a>要求</h2><p>哥德巴赫猜想</p>
<p>Goldbach’s conjecture says that every positive even number greater than 2 is the sum of two prime numbers. E.g. 28 = 5 + 23. It is one of the most famous facts in number theory that has not been proved to be correct in the general case. It has been numerically confirmed up to very large numbers (much larger than Scala’s Int can represent). Write a function to find the two prime numbers that sum up to a given even integer.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="number">28.</span>goldbach</div><div class="line">res0: (<span class="type">Int</span>, <span class="type">Int</span>) = (<span class="number">5</span>,<span class="number">23</span>)</div></pre></td></tr></table></figure>
<h2 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S99Int</span>(<span class="params">val start:<span class="type">Int</span></span>) </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">goldbach</span></span>: (<span class="type">Int</span>, <span class="type">Int</span>) = &#123;</div><div class="line">        <span class="keyword">if</span> (start &lt;= <span class="number">2</span> || (start &amp; <span class="number">1</span>) == <span class="number">1</span>) </div><div class="line">        	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">UnsupportedOperationException</span>(<span class="string">"大于2的偶数才支持此操作"</span>)</div><div class="line"></div><div class="line">        primes.takeWhile(_ &lt;= start)<span class="comment">//可能的素数范围</span></div><div class="line">        .find(e =&gt; (start - e).isPrime) <span class="keyword">match</span> &#123;</div><div class="line">            <span class="keyword">case</span> <span class="type">None</span>    =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">IllegalArgumentException</span></div><div class="line">            <span class="keyword">case</span> <span class="type">Some</span>(x) =&gt; (x, start - x)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="P41-A-list-of-Goldbach-compositions"><a href="#P41-A-list-of-Goldbach-compositions" class="headerlink" title="P41 (**) A list of Goldbach compositions."></a>P41 (**) A list of Goldbach compositions.</h1><h2 id="要求-4"><a href="#要求-4" class="headerlink" title="要求"></a>要求</h2><p>Given a range of integers by its lower and upper limit, print a list of all even numbers and their Goldbach composition.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">scala&gt; printGoldbachList(<span class="number">9</span> to <span class="number">20</span>)</div><div class="line"><span class="number">10</span> = <span class="number">3</span> + <span class="number">7</span></div><div class="line"><span class="number">12</span> = <span class="number">5</span> + <span class="number">7</span></div><div class="line"><span class="number">14</span> = <span class="number">3</span> + <span class="number">11</span></div><div class="line"><span class="number">16</span> = <span class="number">3</span> + <span class="number">13</span></div><div class="line"><span class="number">18</span> = <span class="number">5</span> + <span class="number">13</span></div><div class="line"><span class="number">20</span> = <span class="number">3</span> + <span class="number">17</span></div></pre></td></tr></table></figure>
<p>In most cases, if an even number is written as the sum of two prime numbers, one of them is very small. Very rarely, the primes are both bigger than, say, 50. Try to find out how many such cases there are in the range 2..3000.</p>
<p>Example (minimum value of 50 for the primes):</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">scala&gt; printGoldbachListLimited(<span class="number">1</span> to <span class="number">2000</span>, <span class="number">50</span>)</div><div class="line"><span class="number">992</span> = <span class="number">73</span> + <span class="number">919</span></div><div class="line"><span class="number">1382</span> = <span class="number">61</span> + <span class="number">1321</span></div><div class="line"><span class="number">1856</span> = <span class="number">67</span> + <span class="number">1789</span></div><div class="line"><span class="number">1928</span> = <span class="number">61</span> + <span class="number">1867</span></div><div class="line"><span class="type">The</span> file containing the full <span class="class"><span class="keyword">class</span> <span class="title">for</span> <span class="title">this</span> <span class="title">section</span> <span class="title">is</span> <span class="title">arithmetic</span>.<span class="title">scala</span>.</span></div></pre></td></tr></table></figure>
<h2 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h2><ul>
<li>(1) filter+foreach</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">S99Int</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printGoldbachList</span></span>(r: <span class="type">Range</span>): <span class="type">Unit</span> = &#123;</div><div class="line">        r.filter(e =&gt; e &gt; <span class="number">2</span> &amp;&amp; (e &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="comment">//大于2的偶数</span></div><div class="line">            .foreach(e =&gt; &#123;</div><div class="line">                <span class="keyword">val</span> m = e.goldbach</div><div class="line">                println(e + <span class="string">" = "</span> + m._1 + <span class="string">" + "</span> + m._2)</div><div class="line">            &#125;)</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>(2) 原作者的做法</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">S99Int</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">printGoldbachList</span></span>(r: <span class="type">Range</span>) &#123;</div><div class="line">    printGoldbachListLimited(r, <span class="number">0</span>)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">printGoldbachListLimited</span></span>(r: <span class="type">Range</span>, limit: <span class="type">Int</span>) &#123;</div><div class="line">    (r filter &#123; n =&gt; n &gt; <span class="number">2</span> &amp;&amp; n % <span class="number">2</span> == <span class="number">0</span> &#125; map &#123; n =&gt; (n, n.goldbach) &#125;</div><div class="line">     filter &#123; _._2._1 &gt;= limit &#125; foreach &#123;</div><div class="line">       _ <span class="keyword">match</span> &#123; <span class="keyword">case</span> (n, (p1, p2)) =&gt; println(n + <span class="string">" = "</span> + p1 + <span class="string">" + "</span> + p2) &#125;</div><div class="line">     &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="附录–S99Int-scala"><a href="#附录–S99Int-scala" class="headerlink" title="附录–S99Int.scala"></a>附录–S99Int.scala</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S99Int</span>(<span class="params">val start: <span class="type">Int</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">import</span> <span class="type">S99Int</span>._</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPrime</span></span>: <span class="type">Boolean</span> =</div><div class="line">        (start &gt; <span class="number">1</span>) &amp;&amp; (primes.takeWhile(_ &lt;= <span class="type">Math</span>.sqrt(start)).forall(start % _ != <span class="number">0</span>))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isCoprimeTo</span></span>(x: <span class="type">Int</span>): <span class="type">Boolean</span> = gcd(start, x) == <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totient</span></span>: <span class="type">Int</span> = (<span class="number">1</span> to start).filter(start.isCoprimeTo(_)).length</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totient2</span></span>: <span class="type">Int</span> = start.primeFactorMultiplicity.foldLeft(<span class="number">1</span>) &#123; (r, f) =&gt;</div><div class="line">        f <span class="keyword">match</span> &#123; <span class="keyword">case</span> (p, m) =&gt; r * (p - <span class="number">1</span>) * <span class="type">Math</span>.pow(p, m - <span class="number">1</span>).toInt &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">primeFactors</span></span>: <span class="type">List</span>[<span class="type">Int</span>] = &#123;</div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">primeFactorsR</span></span>(x: <span class="type">Int</span>, ps: <span class="type">Stream</span>[<span class="type">Int</span>]): <span class="type">List</span>[<span class="type">Int</span>] = &#123;</div><div class="line">            x <span class="keyword">match</span> &#123;</div><div class="line">                <span class="comment">//本身就是素数</span></div><div class="line">                <span class="keyword">case</span> n <span class="keyword">if</span> n.isPrime          =&gt; <span class="type">List</span>(n)</div><div class="line">                <span class="comment">//能分解为n*ps.head</span></div><div class="line">                <span class="keyword">case</span> n <span class="keyword">if</span> (n % ps.head) == <span class="number">0</span> =&gt; ps.head :: primeFactorsR(n / ps.head, ps)</div><div class="line">                <span class="comment">//其他</span></div><div class="line">                <span class="keyword">case</span> n                       =&gt; primeFactorsR(n, ps.tail)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> primeFactorsR(start, primes)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">primeFactorMultiplicity</span></span>: <span class="type">Map</span>[<span class="type">Int</span>, <span class="type">Int</span>] = &#123;</div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">factorCount</span></span>(n: <span class="type">Int</span>, p: <span class="type">Int</span>): (<span class="type">Int</span>, <span class="type">Int</span>) =</div><div class="line">            <span class="keyword">if</span> (n % p != <span class="number">0</span>) (<span class="number">0</span>, n)</div><div class="line">            <span class="keyword">else</span> factorCount(n / p, p) <span class="keyword">match</span> &#123; <span class="keyword">case</span> (c, d) =&gt; (c + <span class="number">1</span>, d) &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">factorsR</span></span>(n: <span class="type">Int</span>, ps: <span class="type">Stream</span>[<span class="type">Int</span>]): <span class="type">Map</span>[<span class="type">Int</span>, <span class="type">Int</span>] =</div><div class="line">            <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="type">Map</span>()</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (n.isPrime) <span class="type">Map</span>(n -&gt; <span class="number">1</span>)</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">val</span> nps = ps.dropWhile(n % _ != <span class="number">0</span>)</div><div class="line">                <span class="keyword">val</span> (count, dividend) = factorCount(n, nps.head)</div><div class="line">                <span class="type">Map</span>(nps.head -&gt; count) ++ factorsR(dividend, nps.tail)</div><div class="line">            &#125;</div><div class="line">        factorsR(start, primes)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">goldbach</span></span>: (<span class="type">Int</span>, <span class="type">Int</span>) = &#123;</div><div class="line">        <span class="keyword">if</span> (start &lt;= <span class="number">2</span> || (start &amp; <span class="number">1</span>) == <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">UnsupportedOperationException</span>(<span class="string">"大于2的偶数才支持此操作"</span>)</div><div class="line">        primes.takeWhile(_ &lt;= start).find(e =&gt; (start - e).isPrime) <span class="keyword">match</span> &#123;</div><div class="line">            <span class="keyword">case</span> <span class="type">None</span>    =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">IllegalArgumentException</span></div><div class="line">            <span class="keyword">case</span> <span class="type">Some</span>(x) =&gt; (x, start - x)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">S99Int</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">int2S99Int</span></span>(i: <span class="type">Int</span>): <span class="type">S99Int</span> = <span class="keyword">new</span> <span class="type">S99Int</span>(i)</div><div class="line"></div><div class="line">    <span class="keyword">val</span> primes = <span class="type">Stream</span>.cons(<span class="number">2</span>, <span class="type">Stream</span>.from(<span class="number">3</span>, <span class="number">2</span>) filter &#123; _.isPrime &#125;)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span></span>(m: <span class="type">Int</span>, n: <span class="type">Int</span>): <span class="type">Int</span> = <span class="keyword">if</span> (n == <span class="number">0</span>) m <span class="keyword">else</span> gcd(n, m % n)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">listPrimesinRange</span></span>(r: <span class="type">Range</span>): <span class="type">List</span>[<span class="type">Int</span>] =</div><div class="line">        r.filter(_.isPrime).toList</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">listPrimesinRange2</span></span>(r: <span class="type">Range</span>): <span class="type">List</span>[<span class="type">Int</span>] =</div><div class="line">        primes.dropWhile(_ &lt; r.start).takeWhile(_ &lt;= r.end).toList</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printGoldbachList</span></span>(r: <span class="type">Range</span>): <span class="type">Unit</span> = &#123;</div><div class="line">        r.filter(e =&gt; e &gt; <span class="number">2</span> &amp;&amp; (e &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="comment">//大于2的偶数</span></div><div class="line">            .foreach(e =&gt; &#123;</div><div class="line">                <span class="keyword">val</span> m = e.goldbach</div><div class="line">                println(e + <span class="string">" = "</span> + m._1 + <span class="string">" + "</span> + m._2)</div><div class="line">            &#125;)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></div><div class="tags"><a href="/tags/scala/">scala</a></div><div class="post-nav"><a href="/2017/03/15/problem46-50/" class="pre">problem46-50</a><a href="/2017/03/15/P006-ZigZagConversion/" class="next">P006-ZigZagConversion</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/99-problems-in-scala/">99-problems-in-scala</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-多线程/">Java-多线程</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaSE/">JavaSE</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">LeetCode</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NIO/">NIO</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/app-server/">app-server</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/http-server/">http-server</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kafka/">kafka</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/logging/">logging</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spark/">spark</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring-cloud/">spring-cloud</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/zookeeper/">zookeeper</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/安全/">安全</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/排序/">排序</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/logging/" style="font-size: 15px;">logging</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/jt-808/" style="font-size: 15px;">jt-808</a> <a href="/tags/LeetCode/" style="font-size: 15px;">LeetCode</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/apache-httpd/" style="font-size: 15px;">apache/httpd</a> <a href="/tags/lambda/" style="font-size: 15px;">lambda</a> <a href="/tags/bit/" style="font-size: 15px;">bit</a> <a href="/tags/kafka/" style="font-size: 15px;">kafka</a> <a href="/tags/keytool/" style="font-size: 15px;">keytool</a> <a href="/tags/非对称加密/" style="font-size: 15px;">非对称加密</a> <a href="/tags/NIO/" style="font-size: 15px;">NIO</a> <a href="/tags/scala/" style="font-size: 15px;">scala</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/spark/" style="font-size: 15px;">spark</a> <a href="/tags/安全/" style="font-size: 15px;">安全</a> <a href="/tags/spring-cloud/" style="font-size: 15px;">spring-cloud</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/zookeeper/" style="font-size: 15px;">zookeeper</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/排序/" style="font-size: 15px;">排序</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/java多线程-01-基本概念/">java多线程-01-基本概念</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/排序算法-01-冒泡排序/">排序算法-01-冒泡排序排序算法-01-冒泡排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/常见加密类型及通信安全/">常见加密类型及通信安全</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/git-01-简介、安装和配置/">git-01-简介、安装和配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/httpd系列-00-安装/">httpd系列-00-安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/shiro-常用filter/">shiro-常用filter</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/httpd系列-04-基于openSSL配置HTTPS/">httpd系列-04-基于openSSL配置HTTPS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/problem01-05/">problem01-05</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/java秘钥、证书管理工具-keytool/">java秘钥、证书管理工具-keytool</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/git-02-基本操作/">git-02-基本操作</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">宛丘.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>